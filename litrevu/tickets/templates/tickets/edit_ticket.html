{% extends 'tickets/base.html' %}

{% block title %}Modifier le ticket{% endblock %}

{% block content %}
<div class="form-container">
    <form method="post" action="{% url 'edit_ticket' ticket.id %}" enctype="multipart/form-data">
        {% csrf_token %}
        <h2>Modifier votre ticket</h2>
        <div class="form-group">
            <input type="text" name="title" placeholder="Titre" class="form-control" value="{{ ticket.title }}"
                required>
            {{ form.title.errors }}
        </div>
        <div class="form-group">
            <textarea name="description" placeholder="Description" class="form-control"
                required>{{ ticket.description }}</textarea>
            {{ form.description.errors }}
        </div>
        <div class="form-group image-preview-container">
            <input type="file" name="image" id="imageUpload" class="form-control-file" onchange="previewImage(this);">
            {% if ticket.image %}
            <img src="{{ ticket.image.url }}" alt="Image actuelle" id="imagePreview" class="ticket-image-preview">
            {% else %}
            <img src="" alt="AperÃ§u de l'image" id="imagePreview" style="display: none;">
            {% endif %}
            {{ form.image.errors }}
        </div>
        <div class="form-group">
            <button type="submit" class="btn">Envoyer</button>
        </div>
    </form>
</div>

<script>
    function previewImage(input) {
        if (input.files && input.files[0]) {
            var reader = new FileReader();
            reader.onload = function (e) {
                var preview = document.getElementById('imagePreview');
                preview.src = e.target.result;
                preview.style.display = 'block';
            };
            reader.readAsDataURL(input.files[0]);
        }
    }
</script>
{% endblock %}